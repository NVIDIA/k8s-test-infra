# Example CDI Specification for 2x NVIDIA A100 GPUs
# Simpler configuration for testing and development
# Compatible with CDI specification version 0.5.0
#
# Usage:
#   kubectl create configmap gpu-cdi-spec --from-file=spec.yaml=cdi-spec-a100-2gpu.yaml -n gpu-mock
#   helm upgrade --install gpu-mock ../../helm/gpu-mock \
#     --set cdi.enabled=true \
#     --set cdi.configMapName=gpu-cdi-spec \
#     --namespace gpu-mock

cdiVersion: "0.5.0"
kind: nvidia.com/gpu

devices:
  # GPU 0
  - name: "gpu0"
    annotations:
      nvidia.com/gpu.model: "NVIDIA A100-SXM4-40GB"
      nvidia.com/gpu.uuid: "GPU-00000000-0000-0000-0000-000000000000"
      nvidia.com/gpu.index: "0"
    containerEdits:
      deviceNodes:
        - path: /dev/nvidia0
          type: c
          major: 195
          minor: 0
          fileMode: 0666
      env:
        - NVIDIA_VISIBLE_DEVICES=0
      
  # GPU 1
  - name: "gpu1"
    annotations:
      nvidia.com/gpu.model: "NVIDIA A100-SXM4-40GB"
      nvidia.com/gpu.uuid: "GPU-00000000-0000-0000-0000-000000000001"
      nvidia.com/gpu.index: "1"
    containerEdits:
      deviceNodes:
        - path: /dev/nvidia1
          type: c
          major: 195
          minor: 1
          fileMode: 0666
      env:
        - NVIDIA_VISIBLE_DEVICES=1

